<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Quantifying uncertainty for fitted objects."><title>Quantifying Uncertainty for Fitted Objects — uncertainty • opticut</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantifying Uncertainty for Fitted Objects — uncertainty"><meta property="og:description" content="Quantifying uncertainty for fitted objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">opticut</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/peter-solymos/" aria-label="Linkedin">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/psolymos" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/psolymos" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quantifying Uncertainty for Fitted Objects</h1>
      
      <div class="d-none name"><code>uncertainty.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Quantifying uncertainty for fitted objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">uncertainty</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for opticut</span></span>
<span><span class="fu">uncertainty</span><span class="op">(</span><span class="va">object</span>,</span>
<span>    which <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asymp"</span>, <span class="st">"boot"</span>, <span class="st">"multi"</span><span class="op">)</span>,</span>
<span>    B <span class="op">=</span> <span class="fl">99</span>, cl <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for multicut</span></span>
<span><span class="fu">uncertainty</span><span class="op">(</span><span class="va">object</span>,</span>
<span>    which <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asymp"</span>, <span class="st">"boot"</span><span class="op">)</span>,</span>
<span>    B <span class="op">=</span> <span class="fl">99</span>, cl <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check_strata</span><span class="op">(</span><span class="va">x</span>, <span class="va">mat</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="opticut.html">strata</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, subset<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty1</span></span>
<span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for uncertainty1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for summary.uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sort</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span>, optional <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">sort</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for summary.uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span>, optional <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">sort</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for uncertainty1</span></span>
<span><span class="fu">bsmooth</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for uncertainty</span></span>
<span><span class="fu">bsmooth</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>fitted model object
(which should not contain extra arguments as part of <code>...</code>),
or an output from <code>uncertainty</code> for the <code>summary</code> method.</p></dd>

  <dt>which</dt>
<dd><p>numeric or character (can be a vector) defining
a subset of species from the fitted object,
or or <code>NULL</code> (all species, default).</p></dd>

  <dt>type</dt>
<dd><p>character, describing the type of uncertainty calculation.
See Details.</p></dd>

  <dt>B</dt>
<dd><p>numeric, number of iterations. For <code>type = "boot"</code> and
<code>type = "multi"</code> it can be a user-supplied matrix with indices for
resampling with dimensions length of observations times B.</p></dd>

  <dt>cl</dt>
<dd><p>a cluster object, or an integer for multiple cores in parallel computations
(integer value for forking is ignored on Windows).</p></dd>

  <dt>x</dt>
<dd><p>an object to be printed.</p></dd>

  <dt>level</dt>
<dd><p>the confidence level required.</p></dd>

  <dt>sort</dt>
<dd><p>logical value indicating if species
should be meaningfully sorted, the default is <code>TRUE</code>.</p></dd>

  <dt>digits</dt>
<dd><p>numeric, number of significant digits in output.</p></dd>

  <dt>mat</dt>
<dd><p>a matrix with resampling indices (rows as samples, columns as iterations).</p></dd>


<dt>row.names</dt>
<dd><p><code>NULL</code> or a character vector giving the row names for the data frame.
Missing values are not allowed. See <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>.</p></dd>

<dt>optional</dt>
<dd><p>logical. If <code>TRUE</code>, setting row names and converting column names
(to syntactic names: see <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></code>) is optional.
See <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>.</p></dd>

  <dt>subset</dt>
<dd><p>logical, numeric, or character index indicating species to keep,
missing values are not accepted.</p></dd>

<dt>...</dt>
<dd><p>other arguments passed to the underlying functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uncertainty is calculated for
indicator potential <code>I</code>, and expected values
(<code>mu0</code>, and <code>mu1</code> for opticut, and <code>mu_*</code> for multicut objects).</p>
<p><code>"asymp"</code>: asymptotic distribution is based on best supported model
(this option is unavailable for custom distribution functions because
it requires the Hessian matrix).
This type is available for both opticut and multicut objects.</p>
<p><code>"boot"</code>: non-parametric bootstrap distribution
based on best partition found for the input object.
This type is available for both opticut and multicut objects.</p>
<p><code>"multi"</code>: non-parametric bootstrap distribution
based on best partition found for the bootstrap data (i.e.
the model ranking is re-evaluated each time).
<code>"multi"</code> works only if <code>comb = "rank"</code> in the
<code><a href="opticut.html">opticut</a></code> call.
This type is not available for multicut objects.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>uncertainty</code> returns an object of class 'uncertainty'.
The <code>uncertainty</code> element of the object is a list with species specific
output as elements (object class 'uncertainty1').
Each 'uncertainty1' output is a data frame with columns:
<code>best</code> partition, indicator potential <code>I</code>,
and expected values
(<code>mu0</code>, and <code>mu1</code> for opticut, and <code>mu_*</code> for multicut objects).</p>


<p><code>check_strata</code> returns a logical vector checking if
all original strata from the input object are represented
by resampling indices. Number of strata are attached as attributes
for further diagnostics.</p>


<p>The summary method prints the name of the best supported split,
selection frequency (R, reliability), indicator values (I, based on
the distribution of values within the best supported split with highest
reliability) and confidence interval for I (based on <code>level</code>).</p>


<p>The <code>subset</code> method subsets the species in the uncertainty object.</p>


<p><code><a href="bestmodel.html">bestpart</a></code> finds the selection frequencies for
strata as best partitions (number of strata x number of species).</p>


<p>The coercion method <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> returns a data frame.</p>


<p>The <code>bsmooth</code> method returns bootstrap smoothed results
for each strata (not available for multicut based uncertainty objects,
check uncertainty results instead).</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>Resampling methods can lead to complete exclusion of certain strata
when sample size is small. Try revising the stratification of the
input object, or provide custom resampling indices via the <code>B</code>
argument using stratified (block) bootstrap, jackknife (leave-one-out),
or similar techniques. Finding a suitable random seed
via <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> or dropping unsuitable iterations
can also resolve the issue.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos &lt;psolymos@gmail.com&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="opticut.html">opticut</a></code> and <code><a href="multicut.html">multicut</a></code> for the
user interface of the input objects.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x0</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x0</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lam1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.2</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lam1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lam2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">x3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lam2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Spp1<span class="op">=</span><span class="va">Y1</span>, Spp2<span class="op">=</span><span class="va">Y2</span>, Spp3<span class="op">=</span><span class="va">Y3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="opticut.html">opticut</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">x2</span>, strata<span class="op">=</span><span class="va">x0</span>, dist<span class="op">=</span><span class="st">"poisson"</span>, comb<span class="op">=</span><span class="st">"rank"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## asymptotic confidence intervals</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">uc1</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">oc</span>, type<span class="op">=</span><span class="st">"asymp"</span>, B<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results, type = asymp, B = 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">uc1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type = asymp, B = 999, level = 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split R      I    Lower  Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp1   1+2 1 0.3756 0.205644 0.5150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp3 1+2+3 1 0.3438 0.016874 0.6984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp2 2+3+4 1 0.1354 0.007452 0.2944</span>
<span class="r-in"><span><span class="co">## bootstrap-based confidence intervals</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">uc2</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">oc</span>, type<span class="op">=</span><span class="st">"boot"</span>, B<span class="op">=</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results, type = boot, B = 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">uc2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type = boot, B = 19, level = 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split R      I    Lower  Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp1   1+2 1 0.3688 0.266965 0.4710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp3 1+2+3 1 0.3689 0.023399 0.8796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp2 2+3+4 1 0.1354 0.003183 0.2706</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use user-supplied indices</span></span></span>
<span class="r-in"><span><span class="co">## multi-model bootstrap based uncertainties</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">check_strata</span><span class="op">(</span><span class="va">oc</span>, <span class="va">B</span><span class="op">)</span> <span class="co"># check representation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"nx")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"nmat")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span>
<span class="r-in"><span><span class="op">(</span><span class="va">uc3</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">oc</span>, type<span class="op">=</span><span class="st">"multi"</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results, type = multi, B = 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">uc3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate multicut uncertainty results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type = multi, B = 25, level = 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split      R      I   Lower Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp1   1+2 0.7308 0.3980 0.27604 0.552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp3 1+2+3 0.3846 0.5624 0.21287 1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spp2 2+3+4 0.4615 0.1760 0.09648 0.266</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## best partitions:</span></span></span>
<span class="r-in"><span><span class="co">## selection frequencies for strata and species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">uc3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Spp1       Spp2      Spp3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.0000000 0.03846154 0.6538462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.0000000 0.73076923 0.6538462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0000000 0.92307692 0.8461538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.2692308 0.65384615 0.0000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">uc3</span><span class="op">)</span>, scale<span class="op">=</span><span class="st">"none"</span>, col<span class="op">=</span><span class="fu"><a href="occolors.html">occolors</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## bootstrap smoothed predictions per strata</span></span></span>
<span class="r-in"><span><span class="fu">bsmooth</span><span class="op">(</span><span class="va">uc3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Spp1     Spp2      Spp3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4.242728 3.413736 0.6399826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.242728 4.330780 0.6884190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.808303 4.583842 0.7642625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.429689 4.188160 0.3545554</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">uc3</span><span class="op">)</span>, scale<span class="op">=</span><span class="st">"none"</span>, col<span class="op">=</span><span class="fu"><a href="occolors.html">occolors</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="uncertainty-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## individual species results</span></span></span>
<span class="r-in"><span><span class="va">uc3</span><span class="op">$</span><span class="va">uncertainty</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Spp1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate multicut uncertainty results, type = multi, B = 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      best                 I               mu0             mu1       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Length:26          Min.   :0.2675   Min.   :1.159   Min.   :3.436  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Class :character   1st Qu.:0.3360   1st Qu.:1.502   1st Qu.:3.974  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mode  :character   Median :0.4088   Median :1.777   Median :4.184  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Mean   :0.4065   Mean   :1.808   Mean   :4.243  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     3rd Qu.:0.4719   3rd Qu.:2.108   3rd Qu.:4.405  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Max.   :0.5892   Max.   :2.764   Max.   :5.502  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Spp2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate multicut uncertainty results, type = multi, B = 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      best                 I               mu0             mu1       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Length:26          Min.   :0.0258   Min.   :2.312   Min.   :3.844  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Class :character   1st Qu.:0.1105   1st Qu.:3.097   1st Qu.:4.400  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mode  :character   Median :0.1344   Median :3.359   Median :4.659  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Mean   :0.1559   Mean   :3.394   Mean   :4.627  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     3rd Qu.:0.2209   3rd Qu.:3.724   3rd Qu.:4.944  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Max.   :0.2813   Max.   :4.225   Max.   :5.321  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Spp3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate multicut uncertainty results, type = multi, B = 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      best                 I               mu0              mu1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Length:26          Min.   :0.1554   Min.   :0.0000   Min.   :0.6147  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Class :character   1st Qu.:0.2951   1st Qu.:0.2790   1st Qu.:0.6926  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mode  :character   Median :0.3702   Median :0.3674   Median :0.7865  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Mean   :0.4280   Mean   :0.3546   Mean   :0.8334  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     3rd Qu.:0.4884   3rd Qu.:0.4624   3rd Qu.:0.9216  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Max.   :1.0000   Max.   :0.6937   Max.   :1.7098  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">uc3</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1    1    1    1    1    1    1    1    1     1     1     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    1    1    1    1    1    1    1    1     1     1     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    0    0    0    0    0    0    0    0    0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0    0    0    0    0    0    0    0    0     0     1     0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1     1     1     1     1     1     1     1     1     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1     1     1     1     1     1     1     1     1     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0     0     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0     1     0     1     0     1     1     0     0     0     1     0</span>
<span class="r-in"><span><span class="fu">bsmooth</span><span class="op">(</span><span class="va">uc3</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4.353309 4.123784 4.796411 5.502443 4.966979 3.956581 4.263636 4.066393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.353309 4.123784 4.796411 5.502443 4.966979 3.956581 4.263636 4.066393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.968847 1.752355 2.048311 1.802075 2.764274 1.307073 2.327590 2.026677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.968847 1.752355 2.048311 1.802075 2.764274 1.307073 2.327590 2.026677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4.547626 4.154616 3.436177 4.320181 4.421835 3.510415 4.258540 3.983873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.547626 4.154616 3.436177 4.320181 4.421835 3.510415 4.258540 3.983873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.368197 1.727303 1.399548 2.128446 1.869369 1.312151 1.990268 1.277240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.368197 1.727303 3.436177 2.128446 1.869369 3.510415 1.990268 3.983873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.906009 3.714836 3.921941 4.242182 4.214182 4.605661 3.970598 4.998947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.906009 3.714836 3.921941 4.242182 4.214182 4.605661 3.970598 4.998947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.251073 2.147011 1.628562 2.208800 1.491471 1.532036 1.559550 1.292377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.251073 3.714836 1.628562 4.242182 4.214182 1.532036 1.559550 1.292377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,25]    [,26]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4.049467 4.024312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.049467 4.024312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.158853 1.676410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4.049467 1.676410</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## block bootstrap</span></span></span>
<span class="r-in"><span><span class="va">block_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x0</span><span class="op">==</span><span class="va">z</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x0</span><span class="op">==</span><span class="va">z</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x0</span><span class="op">==</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x0</span><span class="op">==</span><span class="va">z</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fu">block_fun</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">check_strata</span><span class="op">(</span><span class="va">oc</span>, <span class="va">B</span><span class="op">)</span> <span class="co"># check representation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">uncertainty</span><span class="op">(</span><span class="va">oc</span>, type<span class="op">=</span><span class="st">"multi"</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## jackknife</span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">!=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">check_strata</span><span class="op">(</span><span class="va">oc</span>, <span class="va">B</span><span class="op">)</span> <span class="co"># check representation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">uncertainty</span><span class="op">(</span><span class="va">oc</span>, type<span class="op">=</span><span class="st">"multi"</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## multicut based uncertainty</span></span></span>
<span class="r-in"><span><span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="multicut.html">multicut</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">x2</span>, strata<span class="op">=</span><span class="va">x0</span>, dist<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## asymptotic confidence intervals</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">muc1</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">mc</span>, type<span class="op">=</span><span class="st">"asymp"</span>, B<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">muc1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">muc1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## bootstrap-based confidence intervals</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">muc2</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">mc</span>, type<span class="op">=</span><span class="st">"boot"</span>, B<span class="op">=</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">muc2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">muc2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## dolina example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## stratum as ordinal</span></span></span>
<span class="r-in"><span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">stratum</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## filter species to speed up things a bit</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">$</span><span class="va">xtab</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">$</span><span class="va">xtab</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## opticut results, note the cloglog link function</span></span></span>
<span class="r-in"><span><span class="va">dol</span> <span class="op">&lt;-</span> <span class="fu"><a href="opticut.html">opticut</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"binomial:cloglog"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## parallel computing for uncertainty</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ucdol</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">dol</span>, type<span class="op">=</span><span class="st">"multi"</span>, B<span class="op">=</span><span class="fl">25</span>, cl<span class="op">=</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">ucdol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">ucdol</span><span class="op">)</span><span class="op">)</span>, scale<span class="op">=</span><span class="st">"none"</span>, col<span class="op">=</span><span class="fu"><a href="occolors.html">occolors</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    distfun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"manhattan"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## See how indicator value changes with different partitions</span></span></span>
<span class="r-in"><span><span class="co">## (and why it is the wrong metric to use in this calse)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ucdol</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="st">"pvic"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">I</span> <span class="op">~</span> <span class="va">best</span>, col<span class="op">=</span><span class="st">"gold"</span>, ylab<span class="op">=</span><span class="st">"Indicator value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## What we should calculate is the bootstrap smoothed mean of the</span></span></span>
<span class="r-in"><span><span class="co">## expected value and its confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu">bsmooth</span><span class="op">(</span><span class="va">ucdol</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="st">"pvic"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">bs</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"Expected value"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">bs</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bs</span>, <span class="fl">1</span>, <span class="va">quantile</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A more interesting simulated example for bootstrap smoothing</span></span></span>
<span class="r-in"><span><span class="co">## and comparing opticut vs. multicut</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">br</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, by<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">br</span>, include.lowest<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="opticut.html">opticut</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, strata<span class="op">=</span><span class="va">g</span>, dist<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="multicut.html">multicut</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, strata<span class="op">=</span><span class="va">g</span>, dist<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uo</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">o</span>, type<span class="op">=</span><span class="st">"multi"</span>, B<span class="op">=</span><span class="fl">99</span>, cl<span class="op">=</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">um</span> <span class="op">&lt;-</span> <span class="fu">uncertainty</span><span class="op">(</span><span class="va">m</span>, type<span class="op">=</span><span class="st">"boot"</span>, B<span class="op">=</span><span class="fl">99</span>, cl<span class="op">=</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## bootstrap average for opticut</span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu">bsmooth</span><span class="op">(</span><span class="va">uo</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">bs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bs</span>, <span class="fl">1</span>, <span class="va">quantile</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## bootstrap average for multicut</span></span></span>
<span class="r-in"><span><span class="va">bsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">um</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">statm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">bsm</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bsm</span>, <span class="fl">2</span>, <span class="va">quantile</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span> <span class="op">~</span> <span class="va">x</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Binary partitions (opticut)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">br</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">stat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">stat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">stat</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">bs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True response"</span>,<span class="st">"bsmooth"</span>,<span class="st">"0.95 CI"</span>,<span class="st">"Best partition"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span> <span class="op">~</span> <span class="va">x</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Multi-level model (multicut)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">br</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">statm</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">statm</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">br</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">d</span>, <span class="va">statm</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">4</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True response"</span>,<span class="st">"bsmooth"</span>,<span class="st">"0.95 CI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter Solymos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

