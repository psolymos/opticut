<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binary Response Model — opticut • opticut</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binary Response Model — opticut"><meta name="description" content="The functions fits the multi-level response model for each species
by finding the best binary partition based on model selection.
Possibly controlling for modifying/confounding variables.
The general algorithm is described in Kemencei et al. 2014."><meta property="og:description" content="The functions fits the multi-level response model for each species
by finding the best binary partition based on model selection.
Possibly controlling for modifying/confounding variables.
The general algorithm is described in Kemencei et al. 2014."><script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">opticut</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/peter-solymos/" aria-label="Linkedin"><span class="fa fa-linkedin"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/psolymos" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/psolymos" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Binary Response Model</h1>

      <div class="d-none name"><code>opticut.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The functions fits the multi-level response model for each species
by finding the best binary partition based on model selection.
Possibly controlling for modifying/confounding variables.
The general algorithm is described in Kemencei et al. 2014.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">opticut1</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">Z</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, sset<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">opticut</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">strata</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    comb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rank"</span>, <span class="st">"all"</span><span class="op">)</span>, sset<span class="op">=</span><span class="cn">NULL</span>, cl <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">opticut</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">strata</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    comb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rank"</span>, <span class="st">"all"</span><span class="op">)</span>, sset<span class="op">=</span><span class="cn">NULL</span>, cl <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fix_levels</span><span class="op">(</span><span class="va">x</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="fu">strata</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu">strata</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="bestmodel.html">bestmodel</a></span><span class="op">(</span><span class="va">object</span>, which <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">object</span>, pos_only <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="bestmodel.html">getMLE</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">which</span>, vcov<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, subset<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, gnew<span class="op">=</span><span class="cn">NULL</span>, xnew<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut1'</span></span>
<span><span class="fu">wplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">cut</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    las<span class="op">=</span><span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Model weight * Association"</span>, xlab <span class="op">=</span> <span class="st">"Partitions"</span>,</span>
<span>    <span class="va">theme</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span>, bty <span class="op">=</span> <span class="st">"o"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu">wplot</span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">cut</span>, <span class="va">sort</span>,</span>
<span>    las <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Model weight * Association"</span>, xlab <span class="op">=</span> <span class="st">"Partitions"</span>,</span>
<span>    <span class="va">theme</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span>, bty <span class="op">=</span> <span class="st">"o"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">cut</span>, <span class="va">sort</span>,</span>
<span>    <span class="va">las</span>, ylab <span class="op">=</span> <span class="st">"Relative abundance"</span>, xlab <span class="op">=</span> <span class="st">"Strata"</span>,</span>
<span>    show_I <span class="op">=</span> <span class="cn">TRUE</span>, show_S <span class="op">=</span> <span class="cn">TRUE</span>, hr <span class="op">=</span> <span class="cn">TRUE</span>, tick <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">theme</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span>, bty <span class="op">=</span> <span class="st">"o"</span>,</span>
<span>    lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, pos <span class="op">=</span> <span class="fl">0</span>, horizontal<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'opticut1'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cut</span>, <span class="va">sort</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'summary.opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cut</span>, <span class="va">sort</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span>, optional <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">cut</span>, <span class="va">sort</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'summary.opticut'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span>, optional <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">cut</span>, <span class="va">sort</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>two sided model formula, response species data (matrix,
or possible a vector for single species case) in the left-hand side,
model terms for modifying effects in the right-hand side
(its structure depending on the underlying functions).
For example, in the most basic Gaussian case it can be
<code>y ~ 1</code> (no modifying variables) or <code>y ~ x</code>
(with modifying variables).
Centering the modifying terms (or choosing the origin wisely)
is generally recommended (especially for Gaussian distribution
where linear predictors are additive on the response scale)
because the relative abundance contrast is estimated at the origin (0).</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame, list or environment containing the variables
in the model. If not found in data, the variables are taken from
<code><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame()</a></code>, typically the environment
from which <code>opticut</code> is called.</p></dd>

  <dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>vector (usually a factor), unique values define partitions
(must have at least 2 unique levels, empty levels are dropped).
It can also be a matrix with rows as observations and
binary partitions as columns.</p></dd>

  <dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>character or function, a distribution to fit.
If character, it can follow one of these patterns: <code>"family"</code>,
or <code>"family:link"</code> when appropriate (there is a <code>link</code>
argument in the underlying function, or the link
can be specified via the <code>family</code> argument).
See Details and Examples.</p></dd>

  <dt id="arg-comb">comb<a class="anchor" aria-label="anchor" href="#arg-comb"></a></dt>
<dd><p>character, how to define the binary partitions.
<code>"rank"</code> uses <code><a href="rankComb.html">rankComb</a></code>,
<code>"all"</code> uses <code><a href="allComb.html">allComb</a></code>.</p></dd>

  <dt id="arg-sset">sset<a class="anchor" aria-label="anchor" href="#arg-sset"></a></dt>
<dd><p>an optional vector specifying a subset of observations (rows)
to be used in the fitting process. <code>NULL</code> means no subset taken.</p></dd>

  <dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>a cluster object, or an integer for multiple cores in parallel computations
(integer value for forking is ignored on Windows).</p></dd>

  <dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>numeric vector of observations for <code>opticut1</code>,
vector or community matrix for <code>opticut.default</code>.</p></dd>

  <dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric, design matrix. Can be missing, in which case an intercept-only model
is assumed.</p></dd>

  <dt id="arg-z">Z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>factor (must have at least 2 unique levels,
this triggers <code><a href="rankComb.html">rankComb</a></code>),
or a design matrix (custom matrix or as returned by <code><a href="allComb.html">allComb</a></code>.</p></dd>

  <dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>object to plot, print, summarize. For <code>fix_levels</code> it needs to be a factor.</p></dd>

  <dt id="arg-cut">cut<a class="anchor" aria-label="anchor" href="#arg-cut"></a></dt>
<dd><p>log likelihood ratio value to be used as a cut-off for showing species
whose log likelihood ratio is not less than the cut-off.</p></dd>

  <dt id="arg-sort">sort<a class="anchor" aria-label="anchor" href="#arg-sort"></a></dt>
<dd><p>logical value indicating if species/partitions
should be meaningfully sorted, the default is <code>TRUE</code>.
It can take numeric value when only species (<code>1</code>)
or partitions (<code>2</code>) are to be sorted (<code>1:2</code> is equivalent to
<code>TRUE</code>).</p></dd>

  <dt id="arg-show-i">show_I<a class="anchor" aria-label="anchor" href="#arg-show-i"></a></dt>
<dd><p>logical, if indicator potential (I) should be shown.</p></dd>

  <dt id="arg-show-s">show_S<a class="anchor" aria-label="anchor" href="#arg-show-s"></a></dt>
<dd><p>logical, if number of indicator species should be shown.</p></dd>

  <dt id="arg-hr-tick">hr, tick<a class="anchor" aria-label="anchor" href="#arg-hr-tick"></a></dt>
<dd><p>logical, if horizontal rules (<code>hr</code>)
and ticks to the axis legends (<code>tick</code>) should be added.
Default is <code>TRUE</code> for both.</p></dd>

  <dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>color theme as defined by <code><a href="occolors.html">occolors</a></code>.</p></dd>

  <dt id="arg-mar">mar<a class="anchor" aria-label="anchor" href="#arg-mar"></a></dt>
<dd><p>numeric, graphical parameters for plot margin <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>

  <dt id="arg-ylab-xlab-las-ylim">ylab, xlab, las, ylim<a class="anchor" aria-label="anchor" href="#arg-ylab-xlab-las-ylim"></a></dt>
<dd><p>graphical arguments, see <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>.
By default, <code>las</code> is 1 when <code>horizontal = TRUE</code> and
2 when <code>horizontal = FALSE</code>.</p></dd>

  <dt id="arg-bty">bty<a class="anchor" aria-label="anchor" href="#arg-bty"></a></dt>
<dd><p>Character, determines the type of box which is drawn around plots,
see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>

  <dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p>numeric (between 0 and 1), <code>lower</code> is the minimum and
<code>upper</code> is the maximum height for rectangles drawn in the plot.
Both need to be in [0, 1] and <code>higher</code> cannot be smaller than <code>lower</code>.</p></dd>

  <dt id="arg-pos">pos<a class="anchor" aria-label="anchor" href="#arg-pos"></a></dt>
<dd><p>numeric, position of rectangles in the plot relative to the baseline.
Value must be in the [-1, 1] range (below vs. above baseline).</p></dd>

  <dt id="arg-horizontal">horizontal<a class="anchor" aria-label="anchor" href="#arg-horizontal"></a></dt>
<dd><p>logical, plot orientation: species as rows (<code>TRUE</code>)
or as columns (<code>FALSE</code>).</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>numeric, number of significant digits in output.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>numeric or character (can be a vector) defining
a subset of species from the fitted object,
or <code>NULL</code> (all species, default).</p></dd>

  <dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>a character string to separate the sub-strings in factor levels.</p></dd>

<dt id="arg-row-names">row.names<a class="anchor" aria-label="anchor" href="#arg-row-names"></a></dt>
<dd><p><code>NULL</code> or a character vector giving the row names for the data frame.
Missing values are not allowed. See <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>.</p></dd>

<dt id="arg-optional">optional<a class="anchor" aria-label="anchor" href="#arg-optional"></a></dt>
<dd><p>logical. If <code>TRUE</code>, setting row names and converting column names
(to syntactic names: see <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></code>) is optional.
See <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>.</p></dd>

  <dt id="arg-pos-only">pos_only<a class="anchor" aria-label="anchor" href="#arg-pos-only"></a></dt>
<dd><p>logical, best partition normally returns the original variable without
recognizing the direction of the association.
<code>pos_only = TRUE</code> returns values where negative associations are
taken into account and <code>1</code> indicates strata of positive association.
This is only important when <code>comb</code> is not <code>"rank"</code>.</p></dd>

  <dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>logical, numeric, or character index indicating species to keep,
missing values are not accepted. The default <code>NULL</code> returns
the original object without subsetting.</p></dd>

  <dt id="arg-vcov">vcov<a class="anchor" aria-label="anchor" href="#arg-vcov"></a></dt>
<dd><p>logical, if variance-covariance matrix is to be returned.</p></dd>

  <dt id="arg-gnew-xnew">gnew, xnew<a class="anchor" aria-label="anchor" href="#arg-gnew-xnew"></a></dt>
<dd><p>new values for <code>strata</code> and modifiers (right-hand-side of formula)
to predict for, or <code>NULL</code>.
Predicting for new strata available for <code>comb = "rank"</code> models only.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments passed to the underlying functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently available distributions:</p>
<dl><dt><code>"gaussian"</code></dt>
<dd><p>real valued continuous observations, e.g. biomass,
uses <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> of the stats package.
Identity link is assumed. Centering modified variables is generally advised
to avoid negative expected values when the response is nonnegative.</p></dd>


<dt><code>"poisson"</code></dt>
<dd><p>Poisson count data,
uses <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> of the stats package.
Exponential (log) link is assumed.</p></dd>


<dt><code>"binomial"</code></dt>
<dd><p>presence-absence (detection-nondetection) type data,
uses <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> of the stats package.
Logistic (logit) link is assumed.</p></dd>


<dt><code>"negbin"</code></dt>
<dd><p>overdispersed Negative Binomial count data,
uses <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></code> of the MASS package.
Exponential (log) link is assumed.</p></dd>


<dt><code>"beta"</code></dt>
<dd><p>continuous response in the unit interval (0-1),
e.g. percent cover,
uses <code><a href="https://rdrr.io/pkg/betareg/man/betareg.html" class="external-link">betareg</a></code> of the betareg package.
Logistic (logit) link for the mean model is assumed.</p></dd>


<dt><code>"zip"</code></dt>
<dd><p>zero-inflated Poisson counts,
indicative properties are tested as part of the abundance model,
uses <code><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></code> of the pscl package.
Exponential (log) link is used for count based analysis,
the second part of the <code>dist</code> argument following the colon
is used as link function for the zero component (logistic link assumed).</p></dd>


<dt><code>"zinb"</code></dt>
<dd><p>zero-inflated Negative Binomial counts,
indicative properties are tested as part of the abundance model,
uses <code><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></code> of the pscl package.
The zero-inflation component refers to the probability of 0.
Exponential (log) link is used for count based analysis,
the second part of the <code>dist</code> argument following the colon
is used as link function for the zero component (logistic link assumed).</p></dd>


<dt><code>"zip2"</code></dt>
<dd><p>zero-inflated Poisson counts,
indicative properties are tested as part of the zero-model,
uses <code><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></code> of the pscl package.
The zero-inflation component refers to the probability of 1
to be consistent with other methods regarding positive and negative effects.
Logistic (logit) link is assumed for zero-nonzero based analysis,
only symmetric link functions (logit, probit) allowed.
Exponential (log) link is used for the count data part which cannot be changed.</p></dd>


<dt><code>"zinb2"</code></dt>
<dd><p>zero-inflated Negative Binomial counts,
indicative properties are tested as part of the zero-model,
uses <code><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></code> of the pscl package.
The zero-inflation component refers to the probability of 1
to be consistent with other methods regarding positive and negative effects.
Logistic (logit) link is assumed for zero-nonzero based analysis,
only symmetric link functions (logit, probit) allowed.
Exponential (log) link is used for the count data part which cannot be changed.</p></dd>


<dt><code>"rsf"</code></dt>
<dd><p>presence-only data using resource selection
functions (RSF) as explained in  <code><a href="https://rdrr.io/pkg/ResourceSelection/man/rsf.html" class="external-link">rsf</a></code>
in the ResourceSelection package, assuming global availability (<code>m = 0</code>).
The <code>"rsf"</code> works only for single species using <code>opticut1</code>
because 'presence-only' type data cannot be kept in a single
matrix-like object for multiple species.
Intercept only model (i.e. no modifier variables in right-hand-side
of the formula) is accepted for <code>"rsf"</code>.
Exponential (log) link is assumed.</p></dd>


<dt><code>"rspf"</code></dt>
<dd><p>presence-only data using resource selection
probability functions (RSPF)
as explained in <code><a href="https://rdrr.io/pkg/ResourceSelection/man/rsf.html" class="external-link">rspf</a></code>
in the ResourceSelection package, assuming global availability (<code>m = 0</code>).
The <code>"rspf"</code> works only for single species using <code>opticut1</code>
because 'presence-only' type data cannot be kept in a single
matrix-like object for multiple species.
Intercept only model is not accepted for <code>"rspf"</code>, need to have
at least one continuous modifier variable for identifiability
(see Solymos &amp; Lele 2016).
Logistic (logit) link is assumed.</p></dd>


</dl><p>Custom distributions can be defined, see Examples.
Note: not all downstream algorithms and methods work with custom distributions.</p>
<p><code>fix_levels</code> is a utility function for replacing characters in
factor levels that are identical to the value of the
<code>getOption("ocoptions")$collapse</code> value.
This case can lead to an error when specifying the <code>strata</code> argument,
and the <code>fix_levels</code> can help.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The use of the <code>opticut1</code> function is generally discouraged:
some of the internal checks are not guaranteed to
flag issues when the formula-to-model-matrix translation is side-stepped
(this is what is happening when the modifier variables are supplied
as <code>X</code> argument in <code>opticut1</code>).
Use the <code>opticut</code> with a single species instead.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>opticut1</code> returns an object of class opticut1, that is a modified
data frame with additional attributes.</p>
<p><code>opticut</code> returns an object of class opticut, that is a list
with the following components:</p><dl><dt><code>"call"</code></dt>
<dd><p>the function call.</p></dd>

<dt><code>"species"</code></dt>
<dd><p>a list of species specific opticut1 objects.</p></dd>

<dt><code>"X"</code></dt>
<dd><p>modifying variables as model matrix.</p></dd>

<dt><code>"Y"</code></dt>
<dd><p>response, single species vector or matrix.</p></dd>

<dt><code>"strata"</code></dt>
<dd><p>defines the partitions.</p></dd>

<dt><code>"nobs"</code></dt>
<dd><p>sample size.</p></dd>

<dt><code>"sset"</code></dt>
<dd><p>subset, if specified.</p></dd>

<dt><code>"nsplit"</code></dt>
<dd><p>number of binary splits considered.</p></dd>

<dt><code>"dist"</code></dt>
<dd><p>distribution.</p></dd>

<dt><code>"comb"</code></dt>
<dd><p>combination type.</p></dd>

<dt><code>"failed"</code></dt>
<dd><p>IDs for failed species models dropped from results list.</p></dd>

<dt><code>"collapse"</code></dt>
<dd><p>character used for combining partition labels.</p></dd>


</dl><p><code>fix_levels</code> returns a factor with modified levels.</p>
<p>The <code>strata</code> method extracts the <code>strata</code> argument
as factor. The method finds unique row combinations
when custom matrix is supplied for <code>strata</code>.</p>
<p>The <code>print</code> and <code>summary</code> methods are called for their side effects.
The summary shows the following information:
best supported split, strength and sign of association,
indicator potential (I), expected values (mu0, mu1),
log likelihood ratio (logLR), and model weights(w).</p>
<p>The <code>subset</code> method subsets the species in the opticut object.</p>
<p>The <code>plot</code> method presents the contrasts by species and strata.</p>
<p>The <code>wplot</code> (weight plot) shows model weights for partitions.</p>
<p><code><a href="bestmodel.html">bestpart</a></code> returns a matrix with the best supported
partitions for each species (samples and rows, species as columns).</p>
<p><code><a href="bestmodel.html">bestmodel</a></code> returns the best supported model for further
manipulation (e.g. prediction). Note: custom distribution
functions are designed to return only point estimates,
thus the best model cannot be returned. In this case,
use the best partition returned by <code>bestpart</code> to refit the model.
<code>getMLE</code> returns a named list corresponding to the best supported
model. The list has the following elements:
<code>coef</code> is the Maximum Likelihood Estimate (MLE),
<code>vcov</code> is the variance-covariance matrix for the MLE or <code>NULL</code>,
<code>dist</code> is the distribution inherited from input <code>object</code>.</p>
<p><code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></code> returns expected values on the predictor scale
for the observations as a matrix (number of observations by number of species).
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code> returns <code>fitted</code> values when both <code>gnew</code>
and <code>xnew</code> are <code>NULL</code>, or corresponding point predictions
(expected values) on the predictor scale
(available for <code>comb = "rank"</code> models only).</p>
<p>The coercion methods <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code> return a data frame.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kemencei, Z., Farkas, R., Pall-Gergely, B., Vilisics, F., Nagy, A., Hornung,
E. &amp; Solymos, P. (2014): Microhabitat associations of land snails in
forested dolinas: implications for coarse filter conservation.
Community Ecology 15:180–186.
&lt;doi:10.1556/ComEc.15.2014.2.6&gt;</p>
<p>Solymos, P. &amp; Lele, S. R. (2016): Revisiting resource selection probability
functions and single-visit methods: clarification and extensions.
Methods in Ecology and Evolution 7:196–205.
&lt;doi:10.1111/2041-210X.12432&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos &lt;psolymos@gmail.com&gt; and Ermias T. Azeria</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="allComb.html">allComb</a></code>, and <code><a href="rankComb.html">rankComb</a></code>
for partitioning algorithms.</p>
<p><code><a href="beta2i.html">beta2i</a></code> for indicator potential (I) calculations in summaries.</p>
<p><code><a href="bestmodel.html">bestmodel</a></code>, <code><a href="bestmodel.html">bestpart</a></code>, and <code><a href="uncertainty.html">uncertainty</a></code>
for manipulating fitted objects.</p>
<p><code><a href="ocoptions.html">ocoptions</a></code> on how to set some of the global options
related to the presentation of the results in the package
and how errors encountered during model fitting are handled.</p>
<p><code><a href="multicut.html">multicut</a></code> for multinomial-response model,
<code><a href="optilevels.html">optilevels</a></code> for finding the optimal number of factor levels.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## --- Gaussian</span></span></span>
<span class="r-in"><span><span class="co">## simple example from Legendre 2013</span></span></span>
<span class="r-in"><span><span class="co">## Indicator Species: Computation, in</span></span></span>
<span class="r-in"><span><span class="co">## Encyclopedia of Biodiversity, Volume 4</span></span></span>
<span class="r-in"><span><span class="co">## https://dx.doi.org/10.1016/B978-0-12-384719-5.00430-5</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Species1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Species2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Species3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gr</span></span></span>
<span class="r-in"><span><span class="co">## must add some noise to avoid perfect fit</span></span></span>
<span class="r-in"><span><span class="va">spp</span><span class="op">[</span><span class="fl">6</span>, <span class="st">"Species1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span><span class="va">spp</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"Species3"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">17</span></span></span>
<span class="r-in"><span><span class="va">spp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Species1 Species2 Species3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        4        8       17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        4        8       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        4        8       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        4        8       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        4        8       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        7        4        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        6        4        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        6        4        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        6        4        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        6        4        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        5        6        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        5        6        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        5        6        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        5        6        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        5        6        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        3        4        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        3        4        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        3        2        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        3        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        3        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X5        2        0        0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## all partitions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ocall</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">spp</span> <span class="op">~</span> <span class="fl">1</span>, strata<span class="op">=</span><span class="va">gr</span>, dist<span class="op">=</span><span class="st">"gaussian"</span>, comb<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = all, dist = gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = spp ~ 1, strata = gr, dist = "gaussian", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "all")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          split assoc      I mu0  mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species2 X1+X3   +++ 0.9866 2.0  7.0 14.82 0.4995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species1 X2+X3   +++ 0.8617 3.0  5.6 16.74 0.7035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species3    X1   +++ 1.0000 0.5 17.8 54.26 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">spp</span>, strata<span class="op">=</span><span class="va">gr</span>, dist<span class="op">=</span><span class="st">"gaussian"</span>, comb<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span> <span class="co"># alternative</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = all, dist = gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.default(Y = spp, strata = gr, dist = "gaussian", comb = "all")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          split assoc      I mu0  mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species2 X1+X3   +++ 0.9866 2.0  7.0 14.82 0.4995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species1 X2+X3   +++ 0.8617 3.0  5.6 16.74 0.7035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species3    X1   +++ 1.0000 0.5 17.8 54.26 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## rank based partitions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ocrank</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">spp</span> <span class="op">~</span> <span class="fl">1</span>, strata<span class="op">=</span><span class="va">gr</span>, dist<span class="op">=</span><span class="st">"gaussian"</span>, comb<span class="op">=</span><span class="st">"rank"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = rank, dist = gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = spp ~ 1, strata = gr, dist = "gaussian", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "rank")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          split assoc      I mu0  mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species2 X1+X3   +++ 0.9866 2.0  7.0 14.82 0.4996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species1 X2+X3   +++ 0.8617 3.0  5.6 16.74 0.7036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species3    X1   +++ 1.0000 0.5 17.8 54.26 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">spp</span>, strata<span class="op">=</span><span class="va">gr</span>, dist<span class="op">=</span><span class="st">"gaussian"</span>, comb<span class="op">=</span><span class="st">"rank"</span><span class="op">)</span><span class="op">)</span> <span class="co"># alternative</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = rank, dist = gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.default(Y = spp, strata = gr, dist = "gaussian", comb = "rank")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          split assoc      I mu0  mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species2 X1+X3   +++ 0.9866 2.0  7.0 14.82 0.4996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species1 X2+X3   +++ 0.8617 3.0  5.6 16.74 0.7036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species3    X1   +++ 1.0000 0.5 17.8 54.26 1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## --- Binomial</span></span></span>
<span class="r-in"><span><span class="co">## simulated binary data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x0</span> <span class="op">&lt;=</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.8</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x0</span><span class="op">==</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.8</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.8</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">p3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>SPP1<span class="op">=</span><span class="va">Y1</span>, SPP2<span class="op">=</span><span class="va">Y2</span>, SPP3<span class="op">=</span><span class="va">Y3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## all partitions, single species</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="allComb.html">allComb</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">opticut1</span><span class="op">(</span><span class="va">Y1</span>, <span class="va">X</span>, <span class="va">Z</span>, dist<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate opticut results, comb = all, dist = binomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I = 0.7139; w = 0.9989; H = 0.9978; logL_null = -132.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assoc      I    mu0    mu1  logLR         w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1+2   +++ 0.7139 0.3389 0.7544 16.807 9.989e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     --- 0.6557 0.6465 0.2755  9.764 8.724e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     +++ 0.5952 0.4594 0.7700  8.336 2.091e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ++ 0.4260 0.4986 0.7118  3.165 1.188e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      -- 0.3744 0.5914 0.3972  2.500 6.111e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 binary splits (2 models not shown)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## rank based partitions, single species</span></span></span>
<span class="r-in"><span><span class="fu">opticut1</span><span class="op">(</span><span class="va">Y1</span>, <span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span>, dist<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate opticut results, comb = rank, dist = binomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I = 0.7139; w = 0.9989; H = 0.9978; logL_null = -132.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       assoc      I    mu0    mu1  logLR         w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1+2     +++ 0.7139 0.3389 0.7544 16.807 0.9989185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1+2+3   +++ 0.6557 0.2755 0.6465  9.764 0.0008724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       +++ 0.5952 0.4594 0.7700  8.336 0.0002091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 binary splits </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## all partitions, multiple species</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">x2</span>, strata<span class="op">=</span><span class="va">x0</span>, dist<span class="op">=</span><span class="st">"poisson"</span>, comb<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = all, dist = poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = Y ~ x2, strata = x0, dist = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "all")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 species, 7 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = all, dist = poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = Y ~ x2, strata = x0, dist = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "all")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split assoc      I    mu0    mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP1   1+2   +++ 0.4137 0.3118 0.7518 8.340 0.9438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP2     4    ++ 0.3370 0.4550 0.9175 5.664 0.8333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 species not shown</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## show all species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span>, cut<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = all, dist = poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = Y ~ x2, strata = x0, dist = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "all")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split assoc      I    mu0    mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP1   1+2   +++ 0.4137 0.3118 0.7518 8.340 0.9438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP2     4    ++ 0.3370 0.4550 0.9175 5.664 0.8333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 species not shown</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## plot best partitions and indicator values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="opticut-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## model weights for all species</span></span></span>
<span class="r-in"><span><span class="fu">wplot</span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="opticut-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## different ways of plotting weights for single species</span></span></span>
<span class="r-in"><span><span class="fu">wplot</span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">species</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="opticut-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">wplot</span><span class="op">(</span><span class="va">m1</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## rank based partitions, multiple species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">x2</span>, strata<span class="op">=</span><span class="va">x0</span>, dist<span class="op">=</span><span class="st">"poisson"</span>, comb<span class="op">=</span><span class="st">"rank"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = rank, dist = poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = Y ~ x2, strata = x0, dist = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "rank")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split assoc      I    mu0    mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP1   1+2   +++ 0.4137 0.3118 0.7518 8.340 0.9462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP2     4    ++ 0.3370 0.4550 0.9175 5.664 0.8687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 species not shown</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## subset results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">m2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate opticut results, comb = rank, dist = poisson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> opticut.formula(formula = Y ~ x2, strata = x0, dist = "poisson", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     comb = "rank")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best supported models with logLR &gt;= 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      split assoc      I    mu0    mu1 logLR      w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP1   1+2   +++ 0.4137 0.3118 0.7518 8.340 0.9462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SPP2     4    ++ 0.3370 0.4550 0.9175 5.664 0.8687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 binary splits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## best partition</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="bestmodel.html">bestpart</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SPP1 SPP2 SPP3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    0    1    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## best model</span></span></span>
<span class="r-in"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="bestmodel.html">bestmodel</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mods</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SPP1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)`             Z1             x2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.1653         0.8801        -0.2521  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 200 Total (i.e. Null);  197 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    212 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 119.3 	AIC: 313.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SPP2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)`             Z1             x2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -0.7875         0.7014        -0.3343  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 200 Total (i.e. Null);  197 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 116.4 	AIC: 322.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SPP3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)`             Z1             x2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.1635         0.3235        -0.5092  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 200 Total (i.e. Null);  197 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    266 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 126.8 	AIC: 266.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## explore further</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mods</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    2.5 %      97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)` -1.5658931 -0.81050022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z1             0.4493567  1.33725540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2            -0.4472278 -0.05197309</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## MLE and variance-covariance matrix (species 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bestmodel.html">getMLE</a></span><span class="op">(</span><span class="va">m2</span>, which<span class="op">=</span><span class="fl">1</span>, vcov<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)`            Z1            x2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -1.1652948     0.8800652    -0.2520902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vcov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               `(Intercept)`            Z1            x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `(Intercept)`   0.036867825 -0.0356672658 -0.0034330887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z1             -0.035667266  0.0508649662 -0.0001321465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2             -0.003433089 -0.0001321465  0.0101950604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "poisson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fitted values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        SPP1      SPP2      SPP3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.2476256 0.6758558 0.2709819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.3098497 0.9098139 0.4261917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6518694 0.3765488 0.2341692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.7523114 0.4553558 0.3127900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.8162386 0.5073633 0.5096759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.2635700 0.7341598 0.3073866</span>
<span class="r-in"><span><span class="co">## prediction for new data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m2</span>, gnew<span class="op">=</span><span class="va">x0</span>, xnew<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x2<span class="op">=</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        SPP1      SPP2      SPP3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.2476256 0.6758558 0.2709819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.3098497 0.9098139 0.4261917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6518694 0.3765488 0.2341692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.7523114 0.4553558 0.3127900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.8162386 0.5073633 0.5096759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.2635700 0.7341598 0.3073866</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## --- Zero-inflated Negative Binomial</span></span></span>
<span class="r-in"><span><span class="co">## dolina example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## stratum as ordinal</span></span></span>
<span class="r-in"><span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">stratum</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## filter species to speed up things a bit</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">dolina</span><span class="op">$</span><span class="va">xtab</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">dolina</span><span class="op">$</span><span class="va">xtab</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">## opticut results, note the cloglog link function</span></span></span>
<span class="r-in"><span><span class="va">dol</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"zinb:cloglog"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## vertical plot orientation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dol</span>, horizontal<span class="op">=</span><span class="cn">FALSE</span>, pos<span class="op">=</span><span class="fl">1</span>, upper<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## parallel computing comparisons</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## sequential, all combinations (2^(K-1) - 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"zinb"</span>, comb<span class="op">=</span><span class="st">"all"</span>, cl<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## sequential, rank based combinations (K - 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"zinb"</span>, comb<span class="op">=</span><span class="st">"rank"</span>, cl<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## parallel, all combinations (2^(K-1) - 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"zinb"</span>, comb<span class="op">=</span><span class="st">"all"</span>, cl<span class="op">=</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## parallel, rank based combinations (K - 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="st">"zinb"</span>, comb<span class="op">=</span><span class="st">"rank"</span>, cl<span class="op">=</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## --- Customizing distributions</span></span></span>
<span class="r-in"><span><span class="co">## we may want to expand the Zero-inflation component in a ZIP model</span></span></span>
<span class="r-in"><span><span class="co">## see how the return value needs to be structured</span></span></span>
<span class="r-in"><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">linkinv</span>, <span class="va">zi_term</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span><span class="op">-</span><span class="fl">1</span> <span class="op">|</span> <span class="va">zi_term</span>, dist <span class="op">=</span> <span class="st">"poisson"</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coef<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        logLik<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        linkinv<span class="op">=</span><span class="va">mod</span><span class="op">$</span><span class="va">linkinv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">Xdol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## this fits the null model (i.e. no partitions added)</span></span></span>
<span class="r-in"><span><span class="fu">fun</span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>,<span class="st">"amin"</span><span class="op">]</span>, <span class="va">Xdol</span>, zi_term<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">method</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## now we can use dist=fun</span></span></span>
<span class="r-in"><span><span class="fu">opticut1</span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>,<span class="st">"amin"</span><span class="op">]</span>, <span class="va">Xdol</span>, Z<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>,</span></span>
<span class="r-in"><span>    dist<span class="op">=</span><span class="va">fun</span>, zi_term<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">method</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dol2</span> <span class="op">&lt;-</span> <span class="fu">opticut</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">stratum</span> <span class="op">+</span> <span class="va">lmoist</span> <span class="op">+</span> <span class="va">method</span>, data<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span>,</span></span>
<span class="r-in"><span>    strata<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">mhab</span>, dist<span class="op">=</span><span class="va">fun</span>, zi_term<span class="op">=</span><span class="va">dolina</span><span class="op">$</span><span class="va">samp</span><span class="op">$</span><span class="va">method</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dol2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## current collapse value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"ocoptions"</span><span class="op">)</span><span class="op">$</span><span class="va">collapse</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "+"</span>
<span class="r-in"><span><span class="co">## factor levels sometimes need to be manipulated</span></span></span>
<span class="r-in"><span><span class="co">## before feeding it to opticut</span></span></span>
<span class="r-in"><span><span class="fu">fix_levels</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A b"</span>, <span class="st">"C d"</span><span class="op">)</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] A b C d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: A b C d</span>
<span class="r-in"><span><span class="fu">fix_levels</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A b"</span>, <span class="st">"C d"</span><span class="op">)</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] A b C d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: A b C d</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter Solymos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

