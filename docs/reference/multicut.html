<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multi-level Response Model — multicut • opticut</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multi-level Response Model — multicut" />
<meta property="og:description" content="The functions fits the multi-level response model for each species,
possibly controlling for modifying/confounding variables." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">opticut</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/psolymos/opticut">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-level Response Model</h1>
    
    <div class="hidden name"><code>multicut.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions fits the multi-level response model for each species,
possibly controlling for modifying/confounding variables.</p>
    </div>

    <pre class="usage"><span class='fu'>multicut1</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>Z</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>, <span class='kw'>sset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>multicut</span>(<span class='no'>...</span>)
<span class='co'># S3 method for default</span>
<span class='fu'>multicut</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>strata</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>,
    <span class='kw'>sset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for formula</span>
<span class='fu'>multicut</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>strata</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>,
    <span class='kw'>sset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='bestmodel.html'>bestmodel</a></span>(<span class='no'>object</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='opticut.html'>strata</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='bestmodel.html'>getMLE</a></span>(<span class='no'>object</span>, <span class='no'>which</span>, <span class='kw'>vcov</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>x</span>, <span class='kw'>subset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>object</span>, <span class='kw'>gnew</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>xnew</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>cut</span>, <span class='no'>sort</span>,
    <span class='no'>las</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Relative abundance"</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Strata"</span>,
    <span class='kw'>show_I</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>show_S</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>tick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='no'>theme</span>, <span class='kw'>mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>4</span>, <span class='fl'>4</span>, <span class='fl'>4</span>) + <span class='fl'>0.1</span>, <span class='kw'>bty</span> <span class='kw'>=</span> <span class='st'>"o"</span>,
    <span class='kw'>lower</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>pos</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>horizontal</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut1</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>,
    <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Relative abundance"</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Strata"</span>, <span class='no'>...</span>)
<span class='fu'>lcplot</span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut1</span>
<span class='fu'>lcplot</span>(<span class='no'>x</span>,
    <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Cumulative abundance"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Strata"</span>,
    <span class='kw'>bty</span> <span class='kw'>=</span> <span class='st'>"o"</span>, <span class='no'>theme</span>, <span class='no'>...</span>)

<span class='co'># S3 method for multicut1</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>digits</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>digits</span>, <span class='no'>...</span>)
<span class='co'># S3 method for summary.multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>cut</span>, <span class='no'>sort</span>, <span class='no'>digits</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>x</span>,
    <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>optional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>cut</span>, <span class='no'>sort</span>, <span class='no'>...</span>)
<span class='co'># S3 method for summary.multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>x</span>,
    <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>optional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>cut</span>, <span class='no'>sort</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>two sided model formula, response species data (matrix,
or possible a vector for single species case) in the left-hand side,
model terms for modifying effects in the right-hand side
(its structure depending on the underlying functions).
For example, in the most basic Gaussian case it can be
<code>y ~ 1</code> (no modifying variables) or <code>y ~ x</code>
(with modifying variables).
Centering the modifying terms (or choosing the origin wisely)
is generally recommended (especially for Gaussian distribution
where linear predictors are additive on the response scale)
because the relative abundance contrasts are estimated at the origin (0).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame, list or environment containing the variables
in the model. If not found in data, the variables are taken from
<code><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame()</a></code>, typically the environment
from which <code>multicut</code> is called.</p></td>
    </tr>
    <tr>
      <th>strata, Z</th>
      <td><p>a factor, unique values define strata
(must have at least 2 unique levels, empty levels are dropped).</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>character or function, a distribution to fit.
If character, it can follow one of these patterns: <code>"family"</code>,
or <code>"family:link"</code> when appropriate (there is a <code>link</code>
argument in the underlying function, or the link
can be specified via the <code>family</code> argument).
See Details on <code><a href='opticut.html'>opticut</a></code> page and Examples.</p></td>
    </tr>
    <tr>
      <th>sset</th>
      <td><p>an optional vector specifying a subset of observations (rows)
to be used in the fitting process. <code>NULL</code> means no subset taken.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>a cluster object, or an integer for multiple cores in parallel computations
(integer value for forking is ignored on Windows).</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>numeric vector of observations for <code>multicut1</code>,
vector or community matrix for <code>multicut.default</code>.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>numeric, design matrix for possible confounding/modifier variables.
Can be missing, in which case an intercept-only model is assumed.</p></td>
    </tr>
    <tr>
      <th>x, object</th>
      <td><p>object to plot, print, summarize.</p></td>
    </tr>
    <tr>
      <th>cut</th>
      <td><p>log likelihood ratio value to be used as a cut-off for showing species
whose log likelihood ratio is not less than the cut-off.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>logical value indicating if species/partitions
should be meaningfully sorted, the default is <code>TRUE</code>.
It can take numeric value when only species (<code>1</code>)
or partitions (<code>2</code>) are to be sorted (<code>1:2</code> is equivalent to
<code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>show_I</th>
      <td><p>logical, if indicator potential (I) should be shown.</p></td>
    </tr>
    <tr>
      <th>show_S</th>
      <td><p>logical, if number of indicator species should be shown.</p></td>
    </tr>
    <tr>
      <th>hr, tick</th>
      <td><p>logical, if horizontal rules (<code>hr</code>)
and ticks to the axis legends (<code>tick</code>) should be added.
Default is <code>TRUE</code> for both.</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>color theme as defined by <code><a href='occolors.html'>occolors</a></code>.</p></td>
    </tr>
    <tr>
      <th>mar</th>
      <td><p>numeric, graphical parameters for plot margin <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code>.</p></td>
    </tr>
    <tr>
      <th>ylab, xlab, las</th>
      <td><p>graphical arguments, see <code><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></code>.
By default, <code>las</code> is 1 when <code>horizontal = TRUE</code> and
2 when <code>horizontal = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>bty</th>
      <td><p>Character, determines the type of box which is drawn around plots,
see <code><a href='https://rdrr.io/r/graphics/par.html'>par</a></code>.</p></td>
    </tr>
    <tr>
      <th>lower, upper</th>
      <td><p>numeric (between 0 and 1), <code>lower</code> is the minimum and
<code>upper</code> is the maximum height for rectangles drawn in the plot.
Both need to be in [0, 1] and <code>higher</code> cannot be smaller than <code>lower</code>.</p></td>
    </tr>
    <tr>
      <th>pos</th>
      <td><p>numeric, position of rectangles in the plot relative to the baseline.
Value must be in the [-1, 1] range (below vs. above baseline).</p></td>
    </tr>
    <tr>
      <th>horizontal</th>
      <td><p>logical, plot orientation: species as rows (<code>TRUE</code>)
or as columns (<code>FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>numeric, number of significant digits in output.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>numeric or character (can be a vector) defining
a subset of species from the fitted object,
or <code>NULL</code> (all species, default).</p></td>
    </tr>
    <tr>
      <th>row.names</th>
      <td><p><code>NULL</code> or a character vector giving the row names for the data frame.
Missing values are not allowed. See <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>optional</th>
      <td><p>logical. If <code>TRUE</code>, setting row names and converting column names
(to syntactic names: see <code><a href='https://rdrr.io/r/base/make.names.html'>make.names</a></code>) is optional.
See <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>logical, numeric, or character index indicating species to keep,
missing values are not accepted. The default <code>NULL</code> returns
the original object without subsetting.</p></td>
    </tr>
    <tr>
      <th>vcov</th>
      <td><p>logical, if variance-covariance matrix is to be returned.</p></td>
    </tr>
    <tr>
      <th>gnew, xnew</th>
      <td><p>new values for <code>strata</code> and modifiers (right-hand-side of formula)
to predict for, or <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to the underlying functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>The use of the <code>multicut1</code> function is generally discouraged:
some of the internal checks are not guaranteed to
flag issues when the formula-to-model-matrix translation is side-stepped
(this is what is happening when the modifier variables are supplied
as <code>X</code> argument in <code>multicut1</code>).
Use the <code>multicut</code> function with a single species instead.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>multicut1</code> returns an object of class 'multicut1'.</p>
<p><code>multicut</code> returns an object of class 'multicut', that is a list
with the following components:</p><dl class='dl-horizontal'>
<dt><code>"call"</code></dt><dd><p>the function call.</p></dd>
<dt><code>"species"</code></dt><dd><p>a list of species specific multicut1 objects.</p></dd>
<dt><code>"X"</code></dt><dd><p>modifying variables as model matrix.</p></dd>
<dt><code>"Y"</code></dt><dd><p>response, single species vector or matrix.</p></dd>
<dt><code>"strata"</code></dt><dd><p>defines the stratification.</p></dd>
<dt><code>"nobs"</code></dt><dd><p>sample size.</p></dd>
<dt><code>"sset"</code></dt><dd><p>subset, if specified.</p></dd>
<dt><code>"dist"</code></dt><dd><p>distribution.</p></dd>
<dt><code>"failed"</code></dt><dd><p>IDs for failed species models dropped from results list.</p></dd>

</dl>

<p>The <code>strata</code> method extracts the <code>strata</code> argument
as factor.</p>
<p>The <code>print</code> and <code>summary</code> methods are called for their side effects
showing expected values, and log likelihood ratio (logLR).
Optimal binary partitions are determined as part of the
summary based on Lorenz-tangent based thresholding,
which requires nonnegative expected values.
Indicator potential (I) is based on largest the
contrast (difference) between the minimum and maximum
estimates on the linear predictor (link) scale.</p>
<p>The <code>subset</code> method subsets the species in the multicut object.</p>
<p>The <code>plot</code> method presents the estimates by species and strata.
The <code>lcplot</code> method plots the Lorenz curve for a single
species 'multicut1' object.</p>
<p><code><a href='bestmodel.html'>bestpart</a></code> returns a matrix with the best supported
partitions for each species (samples and rows, species as columns).
Binary partitions are based on Lorenz-tangent based optimal threshold
(see <code><a href='lorenz.html'>lorenz</a></code>).
<code><a href='lorenz.html'>lorenz</a></code> requires nonnegative fitted values
which is not guaranteed under <code>dist = "gaussian"</code> with identity
link, see <code>fix_fitted</code> <code><a href='ocoptions.html'>ocoptions</a></code> setting
for how to resolve this (choosing a different link function,
distribution, or centering modified variables is advised).</p>
<p><code><a href='bestmodel.html'>bestmodel</a></code> returns the best supported model for further
manipulation (e.g. prediction). Note: custom distribution
functions are designed to return only point estimates,
thus the best model cannot be returned. In this case,
use the best partition returned by <code>bestpart</code> to refit the model.
<code>getMLE</code> returns a named list corresponding to the best supported
model. The list has the following elements:
<code>coef</code> is the Maximum Likelihood Estimate (MLE),
<code>vcov</code> is the variance-covariance matrix for the MLE or <code>NULL</code>,
<code>dist</code> is the distribution inherited from input <code>object</code>.</p>
<p><code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></code> returns expected values on the predictor scale
for the observations as a matrix (number of observations by number of species).
<code><a href='https://rdrr.io/r/stats/predict.html'>predict</a></code> returns <code>fitted</code> values when both <code>gnew</code>
and <code>xnew</code> are <code>NULL</code>, or corresponding point predictions
(expected values) on the predictor scale.</p>
<p>The coercion methods <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code> return a data frame.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='lorenz.html'>lorenz</a></code> Examples for how multi-level partitions are binarized
using the Lorenz-tangent approach.</p>
<p><code><a href='opticut.html'>opticut</a></code> for optimal binary response model,
<code><a href='optilevels.html'>optilevels</a></code> for finding the optimal number of factor levels.</p>
<p><code><a href='beta2i.html'>beta2i</a></code> for indicator potential (I) calculations in summaries.</p>
<p><code><a href='bestmodel.html'>bestmodel</a></code>, <code><a href='bestmodel.html'>bestpart</a></code>, and <code><a href='uncertainty.html'>uncertainty</a></code>
for manipulating fitted objects.</p>
<p><code><a href='ocoptions.html'>ocoptions</a></code> on how to set some of the global options
related to the presentation of the results in the package
and how errors encountered during model fitting are handled.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## --- Gaussian</span>
<span class='co'>## simple example from Legendre 2013</span>
<span class='co'>## Indicator Species: Computation, in</span>
<span class='co'>## Encyclopedia of Biodiversity, Volume 4</span>
<span class='co'>## http://dx.doi.org/10.1016/B978-0-12-384719-5.00430-5</span>
<span class='no'>gr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"X"</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>5</span>)))
<span class='no'>spp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>Species1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>6</span>,<span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>2</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>5</span>),
    <span class='kw'>Species2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>8</span>,<span class='fl'>4</span>,<span class='fl'>6</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>5</span>), <span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fl'>7</span>)),
    <span class='kw'>Species3</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>18</span>,<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>5</span>))
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>spp</span>) <span class='kw'>&lt;-</span> <span class='no'>gr</span>
<span class='co'>## must add some noise to avoid perfect fit</span>
<span class='no'>spp</span>[<span class='fl'>6</span>, <span class='st'>"Species1"</span>] <span class='kw'>&lt;-</span> <span class='fl'>7</span>
<span class='no'>spp</span>[<span class='fl'>1</span>, <span class='st'>"Species3"</span>] <span class='kw'>&lt;-</span> <span class='fl'>17</span>
<span class='no'>spp</span></div><div class='output co'>#&gt;    Species1 Species2 Species3
#&gt; X1        4        8       17
#&gt; X1        4        8       18
#&gt; X1        4        8       18
#&gt; X1        4        8       18
#&gt; X1        4        8       18
#&gt; X2        7        4        2
#&gt; X2        6        4        2
#&gt; X2        6        4        2
#&gt; X2        6        4        2
#&gt; X2        6        4        2
#&gt; X3        5        6        0
#&gt; X3        5        6        0
#&gt; X3        5        6        0
#&gt; X3        5        6        0
#&gt; X3        5        6        0
#&gt; X4        3        4        0
#&gt; X4        3        4        0
#&gt; X4        3        2        0
#&gt; X4        3        0        0
#&gt; X4        3        0        0
#&gt; X5        2        0        0
#&gt; X5        2        0        0
#&gt; X5        2        0        0
#&gt; X5        2        0        0
#&gt; X5        2        0        0</div><div class='input'>
<span class='co'>## negative expected values are not good</span>
<span class='no'>oco</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ocoptions.html'>ocoptions</a></span>(<span class='kw'>fix_fitted</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>ocall</span> <span class='kw'>&lt;-</span> <span class='fu'>multicut</span>(<span class='no'>spp</span> ~ <span class='fl'>1</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>gr</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"gaussian"</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: Negative fitted values found for 1 species.</span></div><div class='output co'>#&gt; Multivariate multticut results, dist = gaussian
#&gt; 
#&gt; Call:
#&gt; multicut.formula(formula = spp ~ 1, strata = gr, dist = "gaussian")
#&gt; 
#&gt; Species models with logLR &gt;= 2:
#&gt;             split assoc      I logLR
#&gt; Species2 X1+X2+X3   +++ 0.9993 32.53
#&gt; Species1    X2+X3   +++ 0.9705 52.87
#&gt; Species3       X1   +++ 1.0000 91.55
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'>multicut</span>(<span class='no'>spp</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>gr</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"gaussian"</span>)) <span class='co'># alternative</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Negative fitted values found for 1 species.</span></div><div class='output co'>#&gt; Multivariate multticut results, dist = gaussian
#&gt; 
#&gt; Call:
#&gt; multicut.default(Y = spp, strata = gr, dist = "gaussian")
#&gt; 
#&gt; Species models with logLR &gt;= 2:
#&gt;             split assoc      I logLR
#&gt; Species2 X1+X2+X3   +++ 0.9993 32.53
#&gt; Species1    X2+X3   +++ 0.9705 52.87
#&gt; Species3       X1   +++ 1.0000 91.55
#&gt; </div><div class='input'><span class='fu'><a href='ocoptions.html'>ocoptions</a></span>(<span class='no'>oco</span>) <span class='co'># reset options</span>

<span class='co'>## --- Binomial</span>
<span class='co'>## simulated binary data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>
<span class='no'>x0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>4</span>, <span class='no'>n</span>, <span class='fl'>TRUE</span>)
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x0</span> <span class='kw'>&lt;=</span> <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>)
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(-<span class='fl'>0.5</span> + <span class='fl'>2</span>*<span class='no'>x1</span> + -<span class='fl'>0.8</span>*<span class='no'>x2</span>)
<span class='no'>Y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='no'>p1</span>)
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(-<span class='fl'>0.1</span> + <span class='fl'>2</span>*<span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x0</span><span class='kw'>==</span><span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>0</span>) + -<span class='fl'>0.8</span>*<span class='no'>x2</span>)
<span class='no'>Y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='no'>p2</span>)
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(-<span class='fl'>0.1</span> + -<span class='fl'>0.8</span>*<span class='no'>x2</span>)
<span class='no'>Y3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='no'>p3</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>SPP1</span><span class='kw'>=</span><span class='no'>Y1</span>, <span class='kw'>SPP2</span><span class='kw'>=</span><span class='no'>Y2</span>, <span class='kw'>SPP3</span><span class='kw'>=</span><span class='no'>Y3</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span>(~<span class='no'>x2</span>)

(<span class='no'>m0</span> <span class='kw'>&lt;-</span> <span class='fu'>multicut1</span>(<span class='no'>Y1</span>, <span class='no'>X</span>, <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span>(<span class='no'>x0</span>), <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"binomial"</span>))</div><div class='output co'>#&gt; Univariate multicut results, dist = binomial
#&gt; logLR = 17.77 (logL_null = -132.3)
#&gt; 
#&gt; Expected values:
#&gt;      1      2      3      4 
#&gt; 0.7260 0.7771 0.4076 0.2789 
#&gt; </div><div class='input'><span class='fu'>lcplot</span>(<span class='no'>m0</span>)</div><div class='img'><img src='multicut-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>multicut</span>(<span class='no'>Y</span> ~ <span class='no'>x2</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>x0</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"poisson"</span>))</div><div class='output co'>#&gt; Multivariate multticut results, dist = poisson
#&gt; 
#&gt; Call:
#&gt; multicut.formula(formula = Y ~ x2, strata = x0, dist = "poisson")
#&gt; 
#&gt; Species models with logLR &gt;= 2:
#&gt;      split assoc      I logLR
#&gt; SPP1   1+2   +++ 0.5048 8.894
#&gt; SPP2     4    ++ 0.3644 5.902
#&gt; 1 species not shown
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>m1</span>)</div><div class='img'><img src='multicut-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## subset results</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>m1</span>, <span class='fl'>1</span>:<span class='fl'>2</span>))</div><div class='output co'>#&gt; Multivariate multticut results, dist = poisson
#&gt; 
#&gt; Call:
#&gt; multicut.formula(formula = Y ~ x2, strata = x0, dist = "poisson")
#&gt; 
#&gt; Species models with logLR &gt;= 2:
#&gt;      split assoc      I logLR
#&gt; SPP1   1+2   +++ 0.5048 8.894
#&gt; SPP2     4    ++ 0.3644 5.902
#&gt; </div><div class='input'>
<span class='co'>## best partition</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>m1</span>))</div><div class='output co'>#&gt;   SPP1 SPP2 SPP3
#&gt; 4    0    1    1
#&gt; 4    0    1    1
#&gt; 2    1    0    0
#&gt; 2    1    0    0
#&gt; 1    1    0    1
#&gt; 4    0    1    1</div><div class='input'>
<span class='co'>## best model</span>
<span class='no'>mods</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='bestmodel.html'>bestmodel</a></span>(<span class='no'>m1</span>)
<span class='no'>mods</span></div><div class='output co'>#&gt; $SPP1
#&gt; 
#&gt; Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)
#&gt; 
#&gt; Coefficients:
#&gt; `(Intercept)`             Z2             Z3             Z4             x2  
#&gt;      -0.32787        0.07209       -0.65520       -1.03924       -0.25016  
#&gt; 
#&gt; Degrees of Freedom: 200 Total (i.e. Null);  195 Residual
#&gt; Null Deviance:	    212 
#&gt; Residual Deviance: 118.2 	AIC: 316.2
#&gt; 
#&gt; $SPP2
#&gt; 
#&gt; Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)
#&gt; 
#&gt; Coefficients:
#&gt; `(Intercept)`             Z2             Z3             Z4             x2  
#&gt;       -0.6518        -0.1977        -0.1922         0.5662        -0.3358  
#&gt; 
#&gt; Degrees of Freedom: 200 Total (i.e. Null);  195 Residual
#&gt; Null Deviance:	    200 
#&gt; Residual Deviance: 115.9 	AIC: 325.9
#&gt; 
#&gt; $SPP3
#&gt; 
#&gt; Call:  stats::glm(formula = Y ~ . - 1, family = Family, data = XX)
#&gt; 
#&gt; Coefficients:
#&gt; `(Intercept)`             Z2             Z3             Z4             x2  
#&gt;      -0.85213       -0.31133       -0.03570        0.06478       -0.51151  
#&gt; 
#&gt; Degrees of Freedom: 200 Total (i.e. Null);  195 Residual
#&gt; Null Deviance:	    266 
#&gt; Residual Deviance: 126.7 	AIC: 270.7
#&gt; </div><div class='input'><span class='co'>## explore further</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>mods</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; <span class='message'>Waiting for profiling to be done...</span></div><div class='output co'>#&gt;                    2.5 %      97.5 %
#&gt; `(Intercept)` -0.7365077  0.03360653
#&gt; Z2            -0.4137503  0.57263652
#&gt; Z3            -1.2951680 -0.04816757
#&gt; Z4            -1.7561319 -0.38232824
#&gt; x2            -0.4438465 -0.05168407</div><div class='input'>
<span class='co'>## MLE and variance-covariance matrix (species 1)</span>
<span class='fu'><a href='bestmodel.html'>getMLE</a></span>(<span class='no'>m1</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>vcov</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; $coef
#&gt; `(Intercept)`            Z2            Z3            Z4            x2 
#&gt;   -0.32787491    0.07209324   -0.65519918   -1.03924068   -0.25016397 
#&gt; 
#&gt; $vcov
#&gt;               `(Intercept)`            Z2          Z3            Z4
#&gt; `(Intercept)`   0.038311276 -3.706629e-02 -0.03722583 -0.0369859922
#&gt; Z2             -0.037066290  6.267864e-02  0.03704133  0.0370358101
#&gt; Z3             -0.037225827  3.704133e-02  0.09956289  0.0370294262
#&gt; Z4             -0.036985992  3.703581e-02  0.03702943  0.1203610295
#&gt; x2             -0.003575346  8.222807e-05  0.00052985 -0.0001430668
#&gt;                          x2
#&gt; `(Intercept)` -3.575346e-03
#&gt; Z2             8.222807e-05
#&gt; Z3             5.298500e-04
#&gt; Z4            -1.430668e-04
#&gt; x2             1.003152e-02
#&gt; 
#&gt; $dist
#&gt; [1] "poisson"
#&gt; </div><div class='input'>
<span class='co'>## fitted values</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted</a></span>(<span class='no'>m1</span>))</div><div class='output co'>#&gt;        SPP1      SPP2      SPP3
#&gt; 1 0.2027267 0.6752329 0.2850377
#&gt; 2 0.2532343 0.9101916 0.4492035
#&gt; 3 0.6720834 0.3536149 0.2338745
#&gt; 4 0.7747911 0.4279878 0.3127995
#&gt; 5 0.7816706 0.5813804 0.5038994
#&gt; 6 0.2156772 0.7337562 0.3235123</div><div class='input'><span class='co'>## prediction for new data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>m1</span>, <span class='kw'>gnew</span><span class='kw'>=</span><span class='no'>x0</span>, <span class='kw'>xnew</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x2</span><span class='kw'>=</span><span class='no'>x2</span>)))</div><div class='output co'>#&gt;        SPP1      SPP2      SPP3
#&gt; 1 0.2027267 0.6752329 0.2850377
#&gt; 2 0.2532343 0.9101916 0.4492035
#&gt; 3 0.6720834 0.3536149 0.2338745
#&gt; 4 0.7747911 0.4279878 0.3127995
#&gt; 5 0.7816706 0.5813804 0.5038994
#&gt; 6 0.2156772 0.7337562 0.3235123</div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## --- Zero-inflated Negative Binomial</span>
<span class='co'>## dolina example</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dolina</span>)
<span class='co'>## stratum as ordinal</span>
<span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>stratum</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>(<span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>stratum</span>)
<span class='co'>## filter species to speed up things a bit</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='no'>dolina</span>$<span class='no'>xtab</span>[,<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>dolina</span>$<span class='no'>xtab</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>) <span class='kw'>&gt;=</span> <span class='fl'>20</span>]
<span class='co'>## opticut results, note the cloglog link function</span>
<span class='no'>dol</span> <span class='kw'>&lt;-</span> <span class='fu'>multicut</span>(<span class='no'>Y</span> ~ <span class='no'>stratum</span> + <span class='no'>lmoist</span> + <span class='no'>method</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>,
    <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>mhab</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"zinb:cloglog"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>dol</span>)
<span class='co'>## vertical plot orientation</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dol</span>, <span class='kw'>horizontal</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>pos</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>0.8</span>)

<span class='co'>## parallel</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>2</span>)
<span class='fu'>multicut</span>(<span class='no'>Y</span> ~ <span class='no'>stratum</span> + <span class='no'>lmoist</span> + <span class='no'>method</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>,
    <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>mhab</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"zip"</span>,<span class='kw'>cl</span><span class='kw'>=</span><span class='no'>cl</span>)
<span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)

<span class='co'>## --- Customizing distributions</span>
<span class='co'>## we may want to expand the Zero-inflation component in a ZIP model</span>
<span class='co'>## see how the return value needs to be structured</span>
<span class='no'>fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>linkinv</span>, <span class='no'>zi_term</span>, <span class='no'>...</span>) {
    <span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>X</span>)
    <span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>pscl</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pscl/man/zeroinfl.html'>zeroinfl</a></span>(<span class='no'>Y</span> ~ <span class='no'>X</span>-<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>zi_term</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>, <span class='no'>...</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>coef</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>mod</span>),
        <span class='kw'>logLik</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod</span>),
        <span class='kw'>linkinv</span><span class='kw'>=</span><span class='no'>mod</span>$<span class='no'>linkinv</span>)
}
<span class='no'>Xdol</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span>(~ <span class='no'>stratum</span> + <span class='no'>lmoist</span> + <span class='no'>method</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>)
<span class='co'>## this fits the null model (i.e. no partitions added)</span>
<span class='fu'>fun</span>(<span class='no'>Y</span>[,<span class='st'>"amin"</span>], <span class='no'>Xdol</span>, <span class='kw'>zi_term</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>method</span>)
<span class='co'>## now we can use dist=fun</span>
<span class='fu'>multicut1</span>(<span class='no'>Y</span>[,<span class='st'>"amin"</span>], <span class='no'>Xdol</span>, <span class='kw'>Z</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>mhab</span>,
    <span class='kw'>dist</span><span class='kw'>=</span><span class='no'>fun</span>, <span class='kw'>zi_term</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>method</span>)
<span class='no'>dol2</span> <span class='kw'>&lt;-</span> <span class='fu'>multicut</span>(<span class='no'>Y</span> ~ <span class='no'>stratum</span> + <span class='no'>lmoist</span> + <span class='no'>method</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>,
    <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>mhab</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='no'>fun</span>, <span class='kw'>zi_term</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>method</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>dol2</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#warning">Warning</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Peter Solymos &lt;solymos@ualberta.ca&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Solymos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


