<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantifying Uncertainty for Fitted Objects — uncertainty • opticut</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quantifying Uncertainty for Fitted Objects — uncertainty" />
<meta property="og:description" content="Quantifying uncertainty for fitted objects." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">opticut</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/psolymos/opticut">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantifying Uncertainty for Fitted Objects</h1>
    
    <div class="hidden name"><code>uncertainty.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Quantifying uncertainty for fitted objects.</p>
    </div>

    <pre class="usage"><span class='fu'>uncertainty</span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for opticut</span>
<span class='fu'>uncertainty</span>(<span class='no'>object</span>,
    <span class='kw'>which</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"asymp"</span>, <span class='st'>"boot"</span>, <span class='st'>"multi"</span>),
    <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for multicut</span>
<span class='fu'>uncertainty</span>(<span class='no'>object</span>,
    <span class='kw'>which</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"asymp"</span>, <span class='st'>"boot"</span>),
    <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>check_strata</span>(<span class='no'>x</span>, <span class='no'>mat</span>)
<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='opticut.html'>strata</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>x</span>, <span class='kw'>subset</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for uncertainty1</span>
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for uncertainty1</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for summary.uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>sort</span>, <span class='no'>digits</span>, <span class='no'>...</span>)
<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='no'>...</span>)

<span class='co'># S3 method for uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>x</span>,
    <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>optional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>sort</span>, <span class='no'>...</span>)
<span class='co'># S3 method for summary.uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>x</span>,
    <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>optional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>sort</span>, <span class='no'>...</span>)

<span class='co'># S3 method for uncertainty1</span>
<span class='fu'>bsmooth</span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for uncertainty</span>
<span class='fu'>bsmooth</span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>fitted model object
(which should not contain extra arguments as part of <code>...</code>),
or an output from <code>uncertainty</code> for the <code>summary</code> method.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>numeric or character (can be a vector) defining
a subset of species from the fitted object,
or or <code>NULL</code> (all species, default).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>character, describing the type of uncertainty calculation.
See Details.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>numeric, number of iterations. For <code>type = "boot"</code> and
<code>type = "multi"</code> it can be a user-supplied matrix with indices for
resampling with dimensions length of observations times B.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>a cluster object, or an integer for multiple cores in parallel computations
(integer value for forking is ignored on Windows).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an object to be printed.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>the confidence level required.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>logical value indicating if species
should be meaningfully sorted, the default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>numeric, number of significant digits in output.</p></td>
    </tr>
    <tr>
      <th>mat</th>
      <td><p>a matrix with resampling indices (rows as samples, columns as iterations).</p></td>
    </tr>
    <tr>
      <th>row.names</th>
      <td><p><code>NULL</code> or a character vector giving the row names for the data frame.
Missing values are not allowed. See <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>optional</th>
      <td><p>logical. If <code>TRUE</code>, setting row names and converting column names
(to syntactic names: see <code><a href='https://rdrr.io/r/base/make.names.html'>make.names</a></code>) is optional.
See <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>logical, numeric, or character index indicating species to keep,
missing values are not accepted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to the underlying functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Uncertainty is calculated for
indicator potential <code>I</code>, and expected values
(<code>mu0</code>, and <code>mu1</code> for opticut, and <code>mu_*</code> for multicut objects).</p>
<p><code>"asymp"</code>: asymptotic distribution is based on best supported model
(this option is unavailable for custom distribution functions because
it requires the Hessian matrix).
This type is available for both opticut and multicut objects.</p>
<p><code>"boot"</code>: non-parametric bootstrap distribution
based on best partition found for the input object.
This type is available for both opticut and multicut objects.</p>
<p><code>"multi"</code>: non-parametric bootstrap distribution
based on best partition found for the bootstrap data (i.e.
the model ranking is re-evaluated each time).
<code>"multi"</code> works only if <code>comb = "rank"</code> in the
<code><a href='opticut.html'>opticut</a></code> call.
This type is not available for multicut objects.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>uncertainty</code> returns an object of class 'uncertainty'.
The <code>uncertainty</code> element of the object is a list with species specific
output as elements (object class 'uncertainty1').
Each 'uncertainty1' output is a data frame with columns:
<code>best</code> partition, indicator potential <code>I</code>,
and expected values
(<code>mu0</code>, and <code>mu1</code> for opticut, and <code>mu_*</code> for multicut objects).</p>
<p><code>check_strata</code> returns a logical vector checking if
all original strata from the input object are represented
by resampling indices. Number of strata are attached as attributes
for further diagnostics.</p>
<p>The summary method prints the name of the best supported split,
selection frequency (R, reliability), indicator values (I, based on
the distribution of values within the best supported split with highest
reliability) and confidence interval for I (based on <code>level</code>).</p>
<p>The <code>subset</code> method subsets the species in the uncertainty object.</p>
<p><code><a href='bestmodel.html'>bestpart</a></code> finds the selection frequencies for
strata as best partitions (number of strata x number of species).</p>
<p>The coercion method <code><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></code> returns a data frame.</p>
<p>The <code>bsmooth</code> method returns bootstrap smoothed results
for each strata (not available for multicut based uncertainty objects,
check uncertainty results instead).</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>Resampling methods can lead to complete exclusion of certain strata
when sample size is small. Try revising the stratification of the
input object, or provide custom resampling indices via the <code>B</code>
argument using stratified (block) bootstrap, jackknife (leave-one-out),
or similar techniques. Finding a suitable random seed
via <code><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></code> or dropping unsuitable iterations
can also resolve the issue.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='opticut.html'>opticut</a></code> and <code><a href='multicut.html'>multicut</a></code> for the
user interface of the input objects.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>2345</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>
<span class='no'>x0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>4</span>, <span class='no'>n</span>, <span class='fl'>TRUE</span>)
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x0</span> <span class='kw'>%in%</span> <span class='fl'>1</span>:<span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>)
<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>x0</span> <span class='kw'>%in%</span> <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)
<span class='no'>lam1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fl'>0.5</span> + <span class='fl'>1</span>*<span class='no'>x1</span> + -<span class='fl'>0.2</span>*<span class='no'>x2</span>)
<span class='no'>Y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='no'>n</span>, <span class='no'>lam1</span>)
<span class='no'>lam2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fl'>1</span> + <span class='fl'>0.5</span>*<span class='no'>x3</span>)
<span class='no'>Y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='no'>n</span>, <span class='no'>lam2</span>)
<span class='no'>Y3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='no'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fl'>0</span>))
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>Spp1</span><span class='kw'>=</span><span class='no'>Y1</span>, <span class='kw'>Spp2</span><span class='kw'>=</span><span class='no'>Y2</span>, <span class='kw'>Spp3</span><span class='kw'>=</span><span class='no'>Y3</span>)

<span class='no'>oc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='opticut.html'>opticut</a></span>(<span class='no'>Y</span> ~ <span class='no'>x2</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>x0</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"poisson"</span>, <span class='kw'>comb</span><span class='kw'>=</span><span class='st'>"rank"</span>)

<span class='co'>## asymptotic confidence intervals</span>
(<span class='no'>uc1</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>oc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"asymp"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>999</span>))</div><div class='output co'>#&gt; Multivariate multicut uncertainty results, type = asymp, B = 999
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>uc1</span>)</div><div class='output co'>#&gt; Multivariate multicut uncertainty results
#&gt; type = asymp, B = 999, level = 0.95
#&gt; 
#&gt;      split R      I    Lower  Upper
#&gt; Spp1   1+2 1 0.3746 0.204220 0.5118
#&gt; Spp3 1+2+3 1 0.3438 0.016874 0.6984
#&gt; Spp2 2+3+4 1 0.1369 0.008863 0.2939</div><div class='input'><span class='co'>## bootstrap-based confidence intervals</span>
(<span class='no'>uc2</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>oc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"boot"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>19</span>))</div><div class='output co'>#&gt; Multivariate multicut uncertainty results, type = boot, B = 19
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>uc2</span>)</div><div class='output co'>#&gt; Multivariate multicut uncertainty results
#&gt; type = boot, B = 19, level = 0.95
#&gt; 
#&gt;      split R      I    Lower  Upper
#&gt; Spp1   1+2 1 0.3688 0.266965 0.4710
#&gt; Spp3 1+2+3 1 0.3689 0.023399 0.8796
#&gt; Spp2 2+3+4 1 0.1354 0.003183 0.2706</div><div class='input'>
<span class='co'>## use user-supplied indices</span>
<span class='co'>## multi-model bootstrap based uncertainties</span>
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>25</span>, <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='no'>n</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='fu'>check_strata</span>(<span class='no'>oc</span>, <span class='no'>B</span>) <span class='co'># check representation</span></div><div class='output co'>#&gt;  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
#&gt; [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
#&gt; attr(,"nx")
#&gt; [1] 4
#&gt; attr(,"nmat")
#&gt;  [1] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</div><div class='input'>(<span class='no'>uc3</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>oc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"multi"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='no'>B</span>))</div><div class='output co'>#&gt; Multivariate multicut uncertainty results, type = multi, B = 25
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>uc3</span>)</div><div class='output co'>#&gt; Multivariate multicut uncertainty results
#&gt; type = multi, B = 25, level = 0.95
#&gt; 
#&gt;      split      R      I   Lower Upper
#&gt; Spp1   1+2 0.7308 0.3980 0.27604 0.552
#&gt; Spp3 1+2+3 0.3846 0.5624 0.21287 1.000
#&gt; Spp2 2+3+4 0.4615 0.1760 0.09648 0.266</div><div class='input'>
<span class='co'>## best partitions:</span>
<span class='co'>## selection frequencies for strata and species</span>
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>uc3</span>)</div><div class='output co'>#&gt;        Spp1       Spp2      Spp3
#&gt; 1 1.0000000 0.03846154 0.6538462
#&gt; 2 1.0000000 0.73076923 0.6538462
#&gt; 3 0.0000000 0.92307692 0.8461538
#&gt; 4 0.2692308 0.65384615 0.0000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/heatmap.html'>heatmap</a></span>(<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>uc3</span>), <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"none"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='occolors.html'>occolors</a></span>()(<span class='fl'>25</span>))</div><div class='input'>
<span class='co'>## bootstrap smoothed predictions per strata</span>
<span class='fu'>bsmooth</span>(<span class='no'>uc3</span>)</div><div class='output co'>#&gt;       Spp1     Spp2      Spp3
#&gt; 1 4.242728 3.413736 0.6399826
#&gt; 2 4.242728 4.330780 0.6884190
#&gt; 3 1.808303 4.583842 0.7642625
#&gt; 4 2.429689 4.188160 0.3545554</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/heatmap.html'>heatmap</a></span>(<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>uc3</span>), <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"none"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='occolors.html'>occolors</a></span>()(<span class='fl'>25</span>))</div><div class='img'><img src='uncertainty-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## individual species results</span>
<span class='no'>uc3</span>$<span class='no'>uncertainty</span></div><div class='output co'>#&gt; $Spp1
#&gt; Univariate multicut uncertainty results, type = multi, B = 25
#&gt; 
#&gt;     best          I               mu0             mu1       
#&gt;  1+2  :19   Min.   :0.2675   Min.   :1.159   Min.   :3.436  
#&gt;  1+2+4: 7   1st Qu.:0.3360   1st Qu.:1.502   1st Qu.:3.974  
#&gt;             Median :0.4088   Median :1.777   Median :4.184  
#&gt;             Mean   :0.4065   Mean   :1.808   Mean   :4.243  
#&gt;             3rd Qu.:0.4719   3rd Qu.:2.108   3rd Qu.:4.405  
#&gt;             Max.   :0.5892   Max.   :2.764   Max.   :5.502  
#&gt; 
#&gt; $Spp2
#&gt; Univariate multicut uncertainty results, type = multi, B = 25
#&gt; 
#&gt;     best          I               mu0             mu1       
#&gt;  1+3  : 1   Min.   :0.0258   Min.   :2.312   Min.   :3.844  
#&gt;  2    : 1   1st Qu.:0.1105   1st Qu.:3.097   1st Qu.:4.400  
#&gt;  2+3  : 5   Median :0.1344   Median :3.359   Median :4.659  
#&gt;  2+3+4:12   Mean   :0.1559   Mean   :3.394   Mean   :4.627  
#&gt;  2+4  : 1   3rd Qu.:0.2209   3rd Qu.:3.724   3rd Qu.:4.944  
#&gt;  3    : 2   Max.   :0.2813   Max.   :4.225   Max.   :5.321  
#&gt;  3+4  : 4                                                   
#&gt; 
#&gt; $Spp3
#&gt; Univariate multicut uncertainty results, type = multi, B = 25
#&gt; 
#&gt;     best          I               mu0              mu1        
#&gt;  1    : 1   Min.   :0.1554   Min.   :0.0000   Min.   :0.6147  
#&gt;  1+2  : 2   1st Qu.:0.2951   1st Qu.:0.2790   1st Qu.:0.6926  
#&gt;  1+2+3:10   Median :0.3702   Median :0.3674   Median :0.7865  
#&gt;  1+3  : 4   Mean   :0.4280   Mean   :0.3546   Mean   :0.8334  
#&gt;  2    : 1   3rd Qu.:0.4884   3rd Qu.:0.4624   3rd Qu.:0.9216  
#&gt;  2+3  : 4   Max.   :1.0000   Max.   :0.6937   Max.   :1.7098  
#&gt;  3    : 4                                                     
#&gt; </div><div class='input'><span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>uc3</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt;   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
#&gt; 1    1    1    1    1    1    1    1    1    1     1     1     1     1     1
#&gt; 2    1    1    1    1    1    1    1    1    1     1     1     1     1     1
#&gt; 3    0    0    0    0    0    0    0    0    0     0     0     0     0     0
#&gt; 4    0    0    0    0    0    0    0    0    0     0     1     0     0     1
#&gt;   [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
#&gt; 1     1     1     1     1     1     1     1     1     1     1     1     1
#&gt; 2     1     1     1     1     1     1     1     1     1     1     1     1
#&gt; 3     0     0     0     0     0     0     0     0     0     0     0     0
#&gt; 4     0     1     0     1     0     1     1     0     0     0     1     0</div><div class='input'><span class='fu'>bsmooth</span>(<span class='no'>uc3</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt;       [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
#&gt; 1 4.353309 4.123784 4.796411 5.502443 4.966979 3.956581 4.263636 4.066393
#&gt; 2 4.353309 4.123784 4.796411 5.502443 4.966979 3.956581 4.263636 4.066393
#&gt; 3 1.968847 1.752355 2.048311 1.802075 2.764274 1.307073 2.327590 2.026677
#&gt; 4 1.968847 1.752355 2.048311 1.802075 2.764274 1.307073 2.327590 2.026677
#&gt;       [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
#&gt; 1 4.547626 4.154616 3.436177 4.320181 4.421835 3.510415 4.258540 3.983873
#&gt; 2 4.547626 4.154616 3.436177 4.320181 4.421835 3.510415 4.258540 3.983873
#&gt; 3 2.368197 1.727303 1.399548 2.128446 1.869369 1.312151 1.990268 1.277240
#&gt; 4 2.368197 1.727303 3.436177 2.128446 1.869369 3.510415 1.990268 3.983873
#&gt;      [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]
#&gt; 1 3.906009 3.714836 3.921941 4.242182 4.214182 4.605661 3.970598 4.998947
#&gt; 2 3.906009 3.714836 3.921941 4.242182 4.214182 4.605661 3.970598 4.998947
#&gt; 3 2.251073 2.147011 1.628562 2.208800 1.491471 1.532036 1.559550 1.292377
#&gt; 4 2.251073 3.714836 1.628562 4.242182 4.214182 1.532036 1.559550 1.292377
#&gt;      [,25]    [,26]
#&gt; 1 4.049467 4.024312
#&gt; 2 4.049467 4.024312
#&gt; 3 1.158853 1.676410
#&gt; 4 4.049467 1.676410</div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## block bootstrap</span>
<span class='no'>block_fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>()
    <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>x0</span>), <span class='kw'>function</span>(<span class='no'>z</span>) <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x0</span><span class='kw'>==</span><span class='no'>z</span>) <span class='kw'>&lt;</span> <span class='fl'>2</span>)
        <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>(<span class='no'>x0</span><span class='kw'>==</span><span class='no'>z</span>) <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>(<span class='no'>x0</span><span class='kw'>==</span><span class='no'>z</span>), <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x0</span><span class='kw'>==</span><span class='no'>z</span>), <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>)))
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>25</span>, <span class='fu'>block_fun</span>())
<span class='fu'>check_strata</span>(<span class='no'>oc</span>, <span class='no'>B</span>) <span class='co'># check representation</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'>uncertainty</span>(<span class='no'>oc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"multi"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='no'>B</span>))

<span class='co'>## jackknife</span>
<span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>1</span>:<span class='no'>n</span>, <span class='kw'>function</span>(<span class='no'>i</span>) <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>((<span class='fl'>1</span>:<span class='no'>n</span>) <span class='kw'>!=</span> <span class='no'>i</span>))
<span class='fu'>check_strata</span>(<span class='no'>oc</span>, <span class='no'>B</span>) <span class='co'># check representation</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'>uncertainty</span>(<span class='no'>oc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"multi"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='no'>B</span>))

<span class='co'>## multicut based uncertainty</span>
<span class='no'>mc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='multicut.html'>multicut</a></span>(<span class='no'>Y</span> ~ <span class='no'>x2</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>x0</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"poisson"</span>)

<span class='co'>## asymptotic confidence intervals</span>
(<span class='no'>muc1</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>mc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"asymp"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>999</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>muc1</span>)
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>muc1</span>)

<span class='co'>## bootstrap-based confidence intervals</span>
(<span class='no'>muc2</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>mc</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"boot"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>19</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>muc2</span>)
<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>muc2</span>)

<span class='co'>## dolina example</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dolina</span>)
<span class='co'>## stratum as ordinal</span>
<span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>stratum</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>(<span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>stratum</span>)
<span class='co'>## filter species to speed up things a bit</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>dolina</span>$<span class='no'>xtab</span>[,<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>dolina</span>$<span class='no'>xtab</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>) <span class='kw'>&gt;=</span> <span class='fl'>20</span>] <span class='kw'>&gt;</span> <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)
<span class='co'>## opticut results, note the cloglog link function</span>
<span class='no'>dol</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='opticut.html'>opticut</a></span>(<span class='no'>Y</span> ~ <span class='no'>stratum</span> + <span class='no'>lmoist</span> + <span class='no'>method</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>,
    <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>dolina</span>$<span class='no'>samp</span>$<span class='no'>mhab</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"binomial:cloglog"</span>)

<span class='co'>## parallel computing for uncertainty</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>2</span>)
<span class='no'>ucdol</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>dol</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"multi"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>25</span>, <span class='kw'>cl</span><span class='kw'>=</span><span class='no'>cl</span>)
<span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)

<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>ucdol</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/heatmap.html'>heatmap</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='bestmodel.html'>bestpart</a></span>(<span class='no'>ucdol</span>)), <span class='kw'>scale</span><span class='kw'>=</span><span class='st'>"none"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='occolors.html'>occolors</a></span>()(<span class='fl'>25</span>),
    <span class='kw'>distfun</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>x</span>, <span class='st'>"manhattan"</span>))

<span class='co'>## See how indicator value changes with different partitions</span>
<span class='co'>## (and why it is the wrong metric to use in this calse)</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>ucdol</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='st'>"pvic"</span>]],
    <span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span>(<span class='no'>I</span> ~ <span class='no'>best</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"gold"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Indicator value"</span>))
<span class='co'>## What we should calculate is the bootstrap smoothed mean of the</span>
<span class='co'>## expected value and its confidence intervals</span>
<span class='no'>bs</span> <span class='kw'>&lt;-</span> <span class='fu'>bsmooth</span>(<span class='no'>ucdol</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='st'>"pvic"</span>]])
<span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>bs</span>), <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Expected value"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>Mean</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span>(<span class='no'>bs</span>), <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>bs</span>, <span class='fl'>1</span>, <span class='no'>quantile</span>, <span class='kw'>probs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>))))

<span class='co'>## A more interesting simulated example for bootstrap smoothing</span>
<span class='co'>## and comparing opticut vs. multicut</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>2000</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>, -<span class='fl'>8</span>, <span class='fl'>8</span>))
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(<span class='fl'>0.5</span> + -<span class='fl'>0.1</span> * <span class='no'>x</span> + -<span class='fl'>0.2</span> * <span class='no'>x</span>^<span class='fl'>2</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='no'>p</span>)
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>x</span>))/<span class='fl'>10</span>
<span class='no'>br</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>x</span>), <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>x</span>), <span class='kw'>by</span><span class='kw'>=</span><span class='no'>d</span>)
<span class='no'>g</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='no'>x</span>, <span class='no'>br</span>, <span class='kw'>include.lowest</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span>(<span class='no'>g</span>) <span class='kw'>&lt;-</span> <span class='no'>LETTERS</span>[<span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nlevels.html'>nlevels</a></span>(<span class='no'>g</span>)]
<span class='no'>o</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='opticut.html'>opticut</a></span>(<span class='no'>y</span> ~ <span class='fl'>1</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>g</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='multicut.html'>multicut</a></span>(<span class='no'>y</span> ~ <span class='fl'>1</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>g</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>2</span>)
<span class='no'>uo</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>o</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"multi"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>99</span>, <span class='kw'>cl</span><span class='kw'>=</span><span class='no'>cl</span>)
<span class='no'>um</span> <span class='kw'>&lt;-</span> <span class='fu'>uncertainty</span>(<span class='no'>m</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"boot"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>99</span>, <span class='kw'>cl</span><span class='kw'>=</span><span class='no'>cl</span>)
<span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)
<span class='co'>## bootstrap average for opticut</span>
<span class='no'>bs</span> <span class='kw'>&lt;-</span> <span class='fu'>bsmooth</span>(<span class='no'>uo</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='fl'>1</span>]])
<span class='no'>stat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>Mean</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span>(<span class='no'>bs</span>),
    <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>bs</span>, <span class='fl'>1</span>, <span class='no'>quantile</span>, <span class='kw'>probs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>))))
<span class='co'>## bootstrap average for multicut</span>
<span class='no'>bsm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>um</span>$<span class='no'>uncertainty</span><span class='kw'>[[</span><span class='fl'>1</span>]][,-(<span class='fl'>1</span>:<span class='fl'>2</span>)])
<span class='no'>statm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>Mean</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span>(<span class='no'>bsm</span>),
    <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>bsm</span>, <span class='fl'>2</span>, <span class='no'>quantile</span>, <span class='kw'>probs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>))))

<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>p</span> ~ <span class='no'>x</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Binary partitions (opticut)"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span><span class='kw'>=</span><span class='no'>br</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"grey"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>stat</span>[,<span class='fl'>1</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>stat</span>[,<span class='fl'>2</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>stat</span>[,<span class='fl'>3</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>bs</span>[,<span class='fl'>1</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>"topright"</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>2</span>),
    <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"True response"</span>,<span class='st'>"bsmooth"</span>,<span class='st'>"0.95 CI"</span>,<span class='st'>"Best partition"</span>))

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>p</span> ~ <span class='no'>x</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Multi-level model (multicut)"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span><span class='kw'>=</span><span class='no'>br</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"grey"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>statm</span>[,<span class='fl'>1</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>statm</span>[,<span class='fl'>2</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>br</span>[-<span class='fl'>1</span>]-<span class='fl'>0.5</span>*<span class='no'>d</span>, <span class='no'>statm</span>[,<span class='fl'>3</span>], <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='st'>"topright"</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>4</span>),
    <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"True response"</span>,<span class='st'>"bsmooth"</span>,<span class='st'>"0.95 CI"</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#warning">Warning</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Peter Solymos &lt;solymos@ualberta.ca&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Solymos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


